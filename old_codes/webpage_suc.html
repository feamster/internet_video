</video>
  <script>
    const $ = document.querySelector.bind(document)
    const vid = videojs('example_video_1')
    const aud = $('#audio')
    vid.on('play', aud.play.bind(aud))
    vid.on('pause', aud.pause.bind(aud))
    let last = vid.currentTime()
    vid.on('timeupdate', e => {
      let cur = vid.currentTime()
      if (Math.abs(cur - last) > 0.5) {
        aud.currentTime = cur
        last = cur
      }
    })
    vid.on('volumechange', e => {
      aud.volume = vid.volume()
    })
  </script>
 <script>
    videojs('example_video_1').videoJsResolutionSwitcher();
  </script>
  <script type="text/javascript">
    var player = videojs('example_video_1');
    player.on('resolutionchange', function(){
      console.info('Source changed to %s', player.src())
    })
  </script>
  <script>
    var player = videojs('example_video_1');
    var eventPoller = setInterval(function() {
      var buffered = player.buffered();
      var curTime = player.currentTime();
      var currentResolution = player.currentResolutionState.label;
      var source = player.src();
      var mod_num = Math.round(curTime);
      var timestamp = new Date().getTime();
      var url = '/play/post/'

      var httpRequest = new XMLHttpRequest();
      var report = "";

      httpRequest.open('POST', url, true);
      httpRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded");


      for(i=0;i<buffered.length;i++) {
       if (buffered.start(i) <= curTime && curTime <= buffered.end(i)) {
        console.log("Timestamp: " + timestamp + ", "+ "Player Time: " + curTime + ", " + "Current Buffer: " + (buffered.end(i) - curTime) + ", " + "Current Resolution: " + currentResolution);
        report = "Timestamp: " + timestamp + ", "+ "Player Time: " + curTime + ", " + "Current Buffer: " + (buffered.end(i) - curTime) + ", " + "Current Resolution: " + currentResolution;
       }
      }

      httpRequest.send(report);
      httpRequest.onreadystatechange = function () {
         var json = httpRequest.responseText;
      };
    }, 1000)
  </script>
  </div>
</body>
</html>